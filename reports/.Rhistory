filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t") +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b") +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(panel.margin.y = unit(0, "lines"))
ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t") +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b") +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(panel.margin.y = unit(-1, "lines"))
# plot
opt_cue_pl.A <- ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t") +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b") +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(panel.margin.y = unit(0, "lines"))
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.35, 0.65), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1200, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2)
ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t") +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b") +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(strip.text = element_text(size = rel(3.0))
ggplot() +
ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t") +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b") +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(strip.text = element_text(size = rel(3.0)))
ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t") +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b") +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(strip.text.x = element_text(margin = margin(b = 0, t = 0)))
ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t") +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b") +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(strip.text.x = element_text(margin = margin(b = 0.5, t = 0.5)))
# plot
opt_cue_pl.A <- ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t") +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b") +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(strip.text.x = element_text(margin = margin(b = 0.5, t = 0.5)))
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.35, 0.65), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1200, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2)
ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t", outside = T) +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b") +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(strip.text.x = element_text(margin = margin(b = 0.5, t = 0.5)))
ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t", outside = T) +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b") +
coord_cartesian(clip = "off") +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(strip.text.x = element_text(margin = margin(b = 0.5, t = 0.5)))
ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t", length = unit(0.1, "npc")) +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b") +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(strip.text.x = element_text(margin = margin(b = 0.5, t = 0.5)))
# plot
opt_cue_pl.A <- ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t", length = unit(0.1, "npc")) +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b", length = unit(0.1, "npc")) +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(strip.text.x = element_text(margin = margin(b = 0.5, t = 0.5)))
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.35, 0.65), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1200, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2)
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.35, 0.65), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1200, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2)
# plot
opt_cue_pl.A <- ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t", length = unit(0.1, "npc")) +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b", length = unit(0.1, "npc")) +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
ylim(-0.1, 1.1) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(strip.text.x = element_text(margin = margin(b = 0.5, t = 0.5)))
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.35, 0.65), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1100, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2)
# plot
opt_cue_pl.A <- ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t", length = unit(0.1, "npc")) +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b", length = unit(0.1, "npc")) +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
ylim(-0.1, 1.1) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7))  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(strip.text.x = element_text(margin = margin(b = 0.5, t = 0.5)))
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.35, 0.65), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1100, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2)
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.5, 0.5), align = "h", labels = c("A", "B"))
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.5, 0.5), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1100, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2)
# plot
opt_cue_pl.A <- ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t", length = unit(0.1, "npc")) +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b", length = unit(0.1, "npc")) +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
ylim(-0.1, 1.1) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(strip.text.x = element_text(margin = margin(b = 0.5, t = 0.5)))
# plot
opt_cue_pl.A <- ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t", length = unit(0.1, "npc")) +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b", length = unit(0.1, "npc")) +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
ylim(-0.1, 1.1) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(strip.text.x = element_text(margin = margin(b = 0.5, t = 0.5)))
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.45, 0.55), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1100, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2)
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.45, 0.55), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1100, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2)
ggsave(units = "px", dpi = 300, width = 2000, height = 1300, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2.1)
# plot
opt_cue_pl.A <- ggplot() +
geom_line(data = ci_rn.df3, aes(x = cue_range, y = cr, color = "Co-infection")) +
geom_point(data = ci_rn.df3 %>%
group_by(label) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Co-infection", shape = "Co-infection"), size = 2) +
geom_line(data = si_rn.df3, aes(x = cue_range, y = cr, color = "Single infection")) +
geom_point(data = si_rn.df3 %>%
group_by(label_ci) %>%
mutate(ten_th = round(n()/10)) %>%
filter(row_number() %% ten_th == 0), aes(x = cue_range, y = cr, color = "Single infection", shape = "Single infection"), size = 2) +
geom_rug(data = ci_rug.df3, aes(x = value), color = "#4575b4", sides = "t", length = unit(0.1, "npc")) +
geom_rug(data = si_rug.df3, aes(x = value), color = "#fc8d59", sides = "b", length = unit(0.1, "npc")) +
facet_wrap(~ez_label, scales = "free_x", ncol = 2) +
ylim(-0.3, 1.3) +
theme_bw() +
labs(y = "Conversion rate", x = "Cue range", color = "Model", shape = "Model") +
scale_x_continuous(labels = function(x) format(x, scientific = T),
guide = guide_axis(check.overlap = TRUE)) +
theme(axis.text.x = element_text(size = 7),
legend.position = "bottom")  +
scale_color_manual(values=c( "#4575b4", "#fc8d59")) +
theme(strip.text.x = element_text(margin = margin(b = 0.5, t = 0.5)))
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.45, 0.55), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1300, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2.1)
View(opt_cue_pl.A)
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.4, 0.6), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1300, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2.1)
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.4, 0.6), align = "h", labels = c("A", "B"))
opt_cue_pl.B <- ggplot() +
geom_point(data = si_ci_fitness.df, aes(x = fitness_si, y = fitness_ci, color = ez_label_si, shape = ez_label_si), size = 2.5) +
ggrepel::geom_label_repel(data = si_ci_fitness.df, aes(label = ez_label, x = fitness_si, y = fitness_ci),
fill = "white",xlim = c(-Inf, Inf), ylim = c(NA, NA)) +
labs(x = "Maximum single infection fitness", y = "Maximum Co-infection fitness (per strain)",
color = "Single infection cue", shape = "Single infection cue") +
scale_shape_manual(values = 15:24) +
lims(x = c(8, 10.5)) +
geom_vline(xintercept = 9.2, linetype = "dashed", alpha = 0.5) + # si good cue cutoff
geom_hline(yintercept = 2.25, linetype = "dashed", alpha = 0.5) + # ci good cue cutoff
theme_bw() +
coord_cartesian(clip = "off") +
theme(plot.margin=margin(r=0.1))
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.4, 0.6), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1300, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2.1)
opt_cue_pl.B <- ggplot() +
geom_point(data = si_ci_fitness.df, aes(x = fitness_si, y = fitness_ci, color = ez_label_si, shape = ez_label_si), size = 2.5) +
ggrepel::geom_label_repel(data = si_ci_fitness.df, aes(label = ez_label, x = fitness_si, y = fitness_ci),
fill = "white",xlim = c(-Inf, Inf), ylim = c(NA, NA)) +
labs(x = "Maximum single infection fitness", y = "Maximum Co-infection fitness (per strain)",
color = "Single infection cue", shape = "Single infection cue") +
scale_shape_manual(values = 15:24) +
lims(x = c(8, 10.5)) +
geom_vline(xintercept = 9.2, linetype = "dashed", alpha = 0.5) + # si good cue cutoff
geom_hline(yintercept = 2.25, linetype = "dashed", alpha = 0.5) + # ci good cue cutoff
theme_bw() +
coord_cartesian(clip = "off") +
theme(plot.margin=margin(r=0.5))
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.4, 0.6), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1300, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2.1)
opt_cue_pl.B <- ggplot() +
geom_point(data = si_ci_fitness.df, aes(x = fitness_si, y = fitness_ci, color = ez_label_si, shape = ez_label_si), size = 2.5) +
ggrepel::geom_label_repel(data = si_ci_fitness.df, aes(label = ez_label, x = fitness_si, y = fitness_ci),
fill = "white",xlim = c(-Inf, Inf), ylim = c(NA, NA)) +
labs(x = "Maximum single infection fitness", y = "Maximum Co-infection fitness (per strain)",
color = "Single infection cue", shape = "Single infection cue") +
scale_shape_manual(values = 15:24) +
lims(x = c(8, 10.5)) +
geom_vline(xintercept = 9.2, linetype = "dashed", alpha = 0.5) + # si good cue cutoff
geom_hline(yintercept = 2.25, linetype = "dashed", alpha = 0.5) + # ci good cue cutoff
theme_bw() +
coord_cartesian(clip = "off") +
theme(plot.margin=margin(r=10))
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.4, 0.6), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1300, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2.1)
View(rug_lim.final2)
opt_cue_pl.B <- ggplot() +
geom_point(data = si_ci_fitness.df, aes(x = fitness_si, y = fitness_ci, color = ez_label_si, shape = ez_label_si), size = 2.5) +
ggrepel::geom_label_repel(data = si_ci_fitness.df, aes(label = ez_label, x = fitness_si, y = fitness_ci),
fill = "white",xlim = c(-Inf, Inf), ylim = c(NA, NA)) +
labs(x = "Maximum single infection fitness", y = "Maximum Co-infection fitness (per strain)",
color = "Single infection cue", shape = "Single infection cue") +
scale_shape_manual(values = 15:24) +
lims(x = c(8, 10.5)) +
geom_vline(xintercept = 9.2, linetype = "dashed", alpha = 0.5) + # si good cue cutoff
geom_hline(yintercept = 2.25, linetype = "dashed", alpha = 0.5) + # ci good cue cutoff
theme_bw() +
coord_cartesian(clip = "off") +
theme(plot.margin=margin(r=0.5), "cm")
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.4, 0.6), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1300, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2.1)
opt_cue_pl.B <- ggplot() +
geom_point(data = si_ci_fitness.df, aes(x = fitness_si, y = fitness_ci, color = ez_label_si, shape = ez_label_si), size = 2.5) +
ggrepel::geom_label_repel(data = si_ci_fitness.df, aes(label = ez_label, x = fitness_si, y = fitness_ci),
fill = "white",xlim = c(-Inf, Inf), ylim = c(NA, NA)) +
labs(x = "Maximum single infection fitness", y = "Maximum Co-infection fitness (per strain)",
color = "Single infection cue", shape = "Single infection cue") +
scale_shape_manual(values = 15:24) +
lims(x = c(8, 10.5)) +
geom_vline(xintercept = 9.2, linetype = "dashed", alpha = 0.5) + # si good cue cutoff
geom_hline(yintercept = 2.25, linetype = "dashed", alpha = 0.5) + # ci good cue cutoff
theme_bw() +
coord_cartesian(clip = "off") +
theme(plot.margin=margin(r=20), "px")
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.4, 0.6), align = "h", labels = c("A", "B"))
opt_cue_pl.B <- ggplot() +
geom_point(data = si_ci_fitness.df, aes(x = fitness_si, y = fitness_ci, color = ez_label_si, shape = ez_label_si), size = 2.5) +
ggrepel::geom_label_repel(data = si_ci_fitness.df, aes(label = ez_label, x = fitness_si, y = fitness_ci),
fill = "white",xlim = c(-Inf, Inf), ylim = c(NA, NA)) +
labs(x = "Maximum single infection fitness", y = "Maximum Co-infection fitness (per strain)",
color = "Single infection cue", shape = "Single infection cue") +
scale_shape_manual(values = 15:24) +
lims(x = c(8, 10.5)) +
geom_vline(xintercept = 9.2, linetype = "dashed", alpha = 0.5) + # si good cue cutoff
geom_hline(yintercept = 2.25, linetype = "dashed", alpha = 0.5) + # ci good cue cutoff
theme_bw() +
coord_cartesian(clip = "off") +
theme(plot.margin=margin(r=10), "px")
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.4, 0.6), align = "h", labels = c("A", "B"))
opt_cue_pl.B <- ggplot() +
geom_point(data = si_ci_fitness.df, aes(x = fitness_si, y = fitness_ci, color = ez_label_si, shape = ez_label_si), size = 2.5) +
ggrepel::geom_label_repel(data = si_ci_fitness.df, aes(label = ez_label, x = fitness_si, y = fitness_ci),
fill = "white",xlim = c(-Inf, Inf), ylim = c(NA, NA)) +
labs(x = "Maximum single infection fitness", y = "Maximum Co-infection fitness (per strain)",
color = "Single infection cue", shape = "Single infection cue") +
scale_shape_manual(values = 15:24) +
lims(x = c(8, 10.5)) +
geom_vline(xintercept = 9.2, linetype = "dashed", alpha = 0.5) + # si good cue cutoff
geom_hline(yintercept = 2.25, linetype = "dashed", alpha = 0.5) + # ci good cue cutoff
theme_bw() +
coord_cartesian(clip = "off")
ggarrange(opt_cue_pl.A, opt_cue_pl.B, widths = c(0.4, 0.6), align = "h", labels = c("A", "B"))
ggsave(units = "px", dpi = 300, width = 2000, height = 1300, filename = here("figures/plos-bio/rn_fitness.tiff"), bg = "white", scale = 2.1)
