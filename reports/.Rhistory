dual_single_cr.20 <-
dual_single.cr2 %>% filter(status == "Best 20 days dual cue") %>%
select(time, label_new, value) %>%
rbind(time_20.cr2)
## process to match
time_20.cr2 <- time_20.cr %>% filter(variable == "cr") %>% mutate(label_new = "Time") %>% select(-variable)
# filter out the 20 days and 30 days
dual_single_cr.20 <-
dual_single.cr2 %>% filter(status == "Best 20 days dual cue") %>%
select(time, label_new, value) %>%
rbind(time_20.cr2)
time_30.cr2 <- time_30.cr %>% filter(variable == "cr") %>% mutate(label_new = "Time") %>% select(-variable)
dual_single_cr.30 <- dual_single.cr2 %>%
filter(status == "Best 30 days dual cue") %>%
select(time, label_new, value) %>%
rbind(time_30.cr2)
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color = forcats::fct_reorder(label_new, desc(name)), x = time, y = value)) +
viridis::scale_fill_viridis() +
labs(x = "Time (days)", y = "Cue", fill = "Conversion rate") +
xlim(0, 20) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color = forcats::fct_reorder(label_new, desc(value)), x = time, y = value)) +
viridis::scale_fill_viridis() +
labs(x = "Time (days)", y = "Cue", fill = "Conversion rate") +
xlim(0, 20) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color = forcats::fct_reorder(label_new, desc(value)), x = time, y = value)) +
viridis::scale_fill_viridis() +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color = forcats::fct_reorder(label_new, value), x = time, y = value)) +
viridis::scale_fill_viridis() +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color = forcats::fct_reorder(label_new, -value), x = time, y = value)) +
viridis::scale_fill_viridis() +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
theme_bw()
# 30 days
ggplot() +
geom_line(data = dual_single_cr.30, aes(color = forcats::fct_reorder(label_new, -value), x = time, y = value)) +
viridis::scale_fill_viridis() +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 30) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color = forcats::fct_reorder(label_new, -value), x = time, y = value)) +
viridis::scale_fill_viridis() +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
theme_bw()
I_high_20.cr <- chabaudi_si_clean_high(
parameters_cr = c(1.296675,  3.544034 , 4.907484,  2.174249, -3.238309 ,-5.181614 ,-1.645072 , 1.834302 , 1.581011),
immunity = "tsukushi",
parameters = parameters_tsukushi,
time_range = seq(0, 20, by = 1e-3),
cue_range =  seq(0, log10(6*(10^6)), by = (log10(6*(10^6)))/5000),
cue = "I",
log_cue = "log10",
solver = "vode",
dyn = T)
# process
I_high_20.cr2 <- time_20.cr %>% filter(variable == "cr") %>% mutate(label_new = "I log high") %>% select(-variable)
# filter out the 20 days and 30 days
dual_single_cr.20 <- dual_single.cr2 %>%
filter(status == "Best 20 days dual cue") %>%
select(time, label_new, value) %>%
rbind(time_20.cr2, I_high_20.cr2)
dual_single_cr.20
# filter out the 20 days and 30 days
dual_single_cr.20 <- dual_single.cr2 %>%
filter(status == "Best 20 days dual cue") %>%
select(time, label_new, value) %>%
rbind(time_20.cr2, I_high_20.cr2) %>%
mutate(label_new2 = case_when(
label_new == "R log + I log" ~ "RBC logged + asexual iRBC log10",
label_new == "I log" ~ "Asexual iRBC log10",
label_new == "Time" ~ "Time",
label_new == "I log high" ~ "Asexual iRBC log10 flexible"
))
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color = forcats::fct_reorder(label_new2, -value), x = time, y = value)) +
viridis::scale_fill_viridis() +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value)) +
viridis::scale_fill_viridis() +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value), alpha = 0.7) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
theme_bw()
I_high_20.cr2
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value), alpha = 0.7) +
facet_wrap(~label_new2) %>%
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value), alpha = 0.7) +
facet_wrap(~label_new2) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
theme_bw()
# process
I_high_20.cr2 <- I_high_20.cr %>% filter(variable == "cr") %>% mutate(label_new = "I log high") %>% select(-variable)
# filter out the 20 days and 30 days
dual_single_cr.20 <- dual_single.cr2 %>%
filter(status == "Best 20 days dual cue") %>%
select(time, label_new, value) %>%
rbind(time_20.cr2, I_high_20.cr2) %>%
mutate(label_new2 = case_when(
label_new == "R log + I log" ~ "RBC logged + asexual iRBC log10",
label_new == "I log" ~ "Asexual iRBC log10",
label_new == "Time" ~ "Time",
label_new == "I log high" ~ "Asexual iRBC log10 flexible"
))
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value), alpha = 0.7) +
facet_wrap(~label_new2) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value), alpha = 0.7) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value)) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value)) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
scale_color_manual(values = c("#4575b4", "#fc8d59","#fee090", "#91bfdb")) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value)) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
scale_color_manual(values = c("#4575b4", "#91bfdb","#fc8d59","#fee090", )) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value)) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
scale_color_manual(values = c("#4575b4", "#91bfdb","#fc8d59","#fee090")) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value)) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
scale_color_manual(values = c("#4575b4", "#91bfdb","#fc8d59","#fdcb44")) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value), size = 2) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
scale_color_manual(values = c("#4575b4", "#91bfdb","#fc8d59","#fdcb44")) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value), size = 1.5) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
scale_color_manual(values = c("#4575b4", "#91bfdb","#fc8d59","#fdcb44")) +
theme_bw()
# 20 days
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value), size = 1) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
scale_color_manual(values = c("#4575b4", "#91bfdb","#fc8d59","#fdcb44")) +
theme_bw()
# get heat map of best cues
source(here("functions/par_to_hm_te.R"))
R_I.hm <- par_to_hm_te(par = c(4.446192033,	10.97518275,	1.38762817,	23.3059254,	-3.452052371,	-18.0070692,	39.66614226,	-3.545193141,	18.78350799),
cue_range = seq(6,	7, length.out = 500),
cue_range_b = seq(0,	6.77815125, length.out = 500))
# get dynamics
dual.dyn <- lapply(dual_dyn.ls2,
function(x){
# rename column
names(x) <- c("id", "id_b", "label", "label_b", "cue", "cue_b", "time","variable", "value")
df <- x %>% filter(variable %in% c("R", "I", "Ig", "G"))
return(df)}
)
dual.dyn2 <- do.call(rbind, dual.dyn)
## R_I dynamics
R_I.dyn <- dual.dyn2 %>%
filter(label == "R log" & label_b == "I log") %>%
tidyr::pivot_wider(id_cols = time)
dual.dyn2
## R_I dynamics
R_I.dyn <- dual.dyn2 %>%
tidyr::pivot_wider(id_cols = time)
dual.dyn2
# get dynamics
dual.dyn <- lapply(dual_dyn.ls2,
function(x){
# rename column
names(x) <- c("id", "id_b", "label", "label_b", "cue", "cue_b", "time","variable", "value")
df <- x %>% filter(variable %in% c("R", "I"))
return(df)}
)
dual.dyn2 <- do.call(rbind, dual.dyn)
## R_I dynamics
R_I.dyn <- dual.dyn2 %>%
tidyr::pivot_wider(id_cols = time)
dual.dyn2
# plot
## 20 days best cue
ggplot() +
geom_raster(data = R_I.hm, aes(x = cue_range, y = cue_range_b, fill = cr)) +
theme_bw()
R_I.dyn
dual.dyn2
dual_dyn.ls2[[1]]
# get dynamics
dual.dyn <- lapply(dual_dyn.ls2,
function(x){
# rename column
names(x) <- c("id", "id_b", "label", "label_b", "cue", "cue_b", "time","variable", "value")
df <- x %>% filter(variable %in% c("R", "I"))
return(df)}
)
dual.dyn2 <- do.call(rbind, dual.dyn)
dual.dyn2
dual.dyn2 %>%
filter(label == "R log" & label_b == "I log")
## R_I dynamics
R_I.dyn <- dual.dyn2 %>%
filter(label == "R log" & label_b == "I log") %>%
tidyr::pivot_wider(id_cols = time)
dual.dyn2 %>%
filter(label == "R log" & label_b == "I log")
## R_I dynamics
R_I.dyn <- dual.dyn2 %>%
filter(label == "R log" & label_b == "I log") %>%
tidyr::pivot_wider(id_cols = c(time, variable))
## R_I dynamics
R_I.dyn <- dual.dyn2 %>%
filter(label == "R log" & label_b == "I log") %>%
tidyr::pivot_wider(names_from = variable, value_from = value)
dual.dyn2
## R_I dynamics
R_I.dyn <- dual.dyn2 %>%
filter(label == "R log" & label_b == "I log") %>%
tidyr::pivot_wider(names_from = variable, values_from = value)
R_I.dyn
# plot
## 20 days best cue
ggplot() +
geom_raster(data = R_I.hm, aes(x = cue_range, y = cue_range_b, fill = cr)) +
scale_fill_viridis_c() +
geom_path(data = R_I.dyn, aes(x = log_R, y = log_I), color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = R_I.dyn %>% filter(row_number() %% 100 == 1), aes(x = log_R, y = log_I), color = "white") +
xlim(0.95*min(hablar::s(R_I.dyn$log_R), na.rm = T), 1.05* max(hablar::s(R_I.dyn$log_R), na.rm = T)) +
ylim(0.95*min(hablar::s(R_I.dyn$log_I), na.rm = T),1.05* max(hablar::s(R_I.dyn$log_I), na.rm = T)) +
labs(x = "RBC logged", y = "Asexual iRBC logged", fill = "Conversion rate") +
theme_bw()
## R_I dynamics
R_I.dyn <- dual.dyn2 %>%
filter(label == "R log" & label_b == "I log") %>%
tidyr::pivot_wider(names_from = variable, values_from = value) %>%
mutate(log_R = log10(R),
log_I = log(I))
# plot
## 20 days best cue
ggplot() +
geom_raster(data = R_I.hm, aes(x = cue_range, y = cue_range_b, fill = cr)) +
scale_fill_viridis_c() +
geom_path(data = R_I.dyn, aes(x = log_R, y = log_I), color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = R_I.dyn %>% filter(row_number() %% 100 == 1), aes(x = log_R, y = log_I), color = "white") +
xlim(0.95*min(hablar::s(R_I.dyn$log_R), na.rm = T), 1.05* max(hablar::s(R_I.dyn$log_R), na.rm = T)) +
ylim(0.95*min(hablar::s(R_I.dyn$log_I), na.rm = T),1.05* max(hablar::s(R_I.dyn$log_I), na.rm = T)) +
labs(x = "RBC logged", y = "Asexual iRBC logged", fill = "Conversion rate") +
theme_bw()
# plot
## 20 days best cue
ggplot() +
geom_raster(data = R_I.hm, aes(x = cue_range, y = cue_range_b, fill = cr)) +
scale_fill_viridis_c() +
geom_path(data = R_I.dyn, aes(x = log_R, y = log_I), color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = R_I.dyn %>% filter(row_number() %% 100 == 1), aes(x = log_R, y = log_I), color = "white") +
#xlim(0.95*min(hablar::s(R_I.dyn$log_R), na.rm = T), 1.05* max(hablar::s(R_I.dyn$log_R), na.rm = T)) +
#ylim(0.95*min(hablar::s(R_I.dyn$log_I), na.rm = T),1.05* max(hablar::s(R_I.dyn$log_I), na.rm = T)) +
labs(x = "RBC logged", y = "Asexual iRBC logged", fill = "Conversion rate") +
theme_bw()
## R_I dynamics
R_I.dyn <- dual.dyn2 %>%
filter(label == "R log" & label_b == "I log") %>%
tidyr::pivot_wider(names_from = variable, values_from = value) %>%
mutate(log_R = log10(R),
log_I = log10(I))
# plot
## 20 days best cue
ggplot() +
geom_raster(data = R_I.hm, aes(x = cue_range, y = cue_range_b, fill = cr)) +
scale_fill_viridis_c() +
geom_path(data = R_I.dyn, aes(x = log_R, y = log_I), color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = R_I.dyn %>% filter(row_number() %% 100 == 1), aes(x = log_R, y = log_I), color = "white") +
xlim(0.95*min(hablar::s(R_I.dyn$log_R), na.rm = T), 1.05* max(hablar::s(R_I.dyn$log_R), na.rm = T)) +
ylim(0.95*min(hablar::s(R_I.dyn$log_I), na.rm = T),1.05* max(hablar::s(R_I.dyn$log_I), na.rm = T)) +
labs(x = "RBC logged", y = "Asexual iRBC logged", fill = "Conversion rate") +
theme_bw()
# plot
## 20 days best cue
ggplot() +
geom_raster(data = R_I.hm, aes(x = cue_range, y = cue_range_b, fill = cr)) +
scale_fill_viridis_c() +
geom_path(data = R_I.dyn, aes(x = log_R, y = log_I), color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = R_I.dyn %>% filter(row_number() %% 100 == 1), aes(x = log_R, y = log_I), color = "white") +
xlim(0.99*min(hablar::s(R_I.dyn$log_R), na.rm = T), 1.01* max(hablar::s(R_I.dyn$log_R), na.rm = T)) +
ylim(0.99*min(hablar::s(R_I.dyn$log_I), na.rm = T),1.01* max(hablar::s(R_I.dyn$log_I), na.rm = T)) +
labs(x = "RBC logged", y = "Asexual iRBC logged", fill = "Conversion rate") +
theme_bw()
# plot
## 20 days best cue
ggplot() +
geom_raster(data = R_I.hm, aes(x = cue_range, y = cue_range_b, fill = cr)) +
scale_fill_viridis_c() +
geom_path(data = R_I.dyn, aes(x = log_R, y = log_I), color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = R_I.dyn %>% filter(row_number() %% 100 == 1), aes(x = log_R, y = log_I), color = "white") +
xlim(0.99*min(hablar::s(R_I.dyn$log_R), na.rm = T), 1.01* max(hablar::s(R_I.dyn$log_R), na.rm = T)) +
ylim(0.99*min(hablar::s(R_I.dyn$log_I), na.rm = T),1.01* max(hablar::s(R_I.dyn$log_I), na.rm = T)) +
labs(x = "RBC logged", y = "Asexual iRBC logged", fill = "Conversion rate")
# plot
## 20 days best cue
ggplot() +
geom_raster(data = R_I.hm, aes(x = cue_range, y = cue_range_b, fill = cr)) +
scale_fill_viridis_c() +
geom_path(data = R_I.dyn, aes(x = log_R, y = log_I), color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = R_I.dyn %>% filter(row_number() %% 1000 == 1), aes(x = log_R, y = log_I), color = "white") +
xlim(0.99*min(hablar::s(R_I.dyn$log_R), na.rm = T), 1.01* max(hablar::s(R_I.dyn$log_R), na.rm = T)) +
ylim(0.99*min(hablar::s(R_I.dyn$log_I), na.rm = T),1.01* max(hablar::s(R_I.dyn$log_I), na.rm = T)) +
labs(x = "RBC logged", y = "Asexual iRBC logged", fill = "Conversion rate")
# plot
## 20 days best cue
ggplot() +
geom_raster(data = R_I.hm, aes(x = cue_range, y = cue_range_b, fill = cr)) +
scale_fill_viridis_c() +
geom_path(data = R_I.dyn, aes(x = log_R, y = log_I), color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = R_I.dyn %>% filter(row_number() %% 1000 == 1 & time <= 20), aes(x = log_R, y = log_I), color = "white") +
xlim(0.99*min(hablar::s(R_I.dyn$log_R), na.rm = T), 1.01* max(hablar::s(R_I.dyn$log_R), na.rm = T)) +
ylim(0.99*min(hablar::s(R_I.dyn$log_I), na.rm = T),1.01* max(hablar::s(R_I.dyn$log_I), na.rm = T)) +
labs(x = "RBC logged", y = "Asexual iRBC logged", fill = "Conversion rate")
# plot
## 20 days best cue
ggplot() +
geom_raster(data = R_I.hm, aes(x = cue_range, y = cue_range_b, fill = cr)) +
scale_fill_viridis_c() +
geom_path(data = R_I.dyn, aes(x = log_R, y = log_I), color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = R_I.dyn %>% filter(row_number() %% 1000 == 1 & time <= 20), aes(x = log_R, y = log_I), color = "white") +
xlim(0.99*min(hablar::s(R_I.dyn$log_R), na.rm = T), 1.01* max(hablar::s(R_I.dyn$log_R), na.rm = T)) +
ylim(0.98*min(hablar::s(R_I.dyn$log_I), na.rm = T),1.01* max(hablar::s(R_I.dyn$log_I), na.rm = T)) +
labs(x = "RBC logged", y = "Asexual iRBC logged", fill = "Conversion rate")
# plot
## 20 days best cue
ggplot() +
geom_raster(data = R_I.hm, aes(x = cue_range, y = cue_range_b, fill = cr)) +
scale_fill_viridis_c() +
geom_path(data = R_I.dyn, aes(x = log_R, y = log_I), color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = R_I.dyn %>% filter(row_number() %% 1000 == 1 & time <= 20), aes(x = log_R, y = log_I), color = "white") +
xlim(0.99*min(hablar::s(R_I.dyn$log_R), na.rm = T), 1.01* max(hablar::s(R_I.dyn$log_R), na.rm = T)) +
ylim(0.99*min(hablar::s(R_I.dyn$log_I), na.rm = T),1.01* max(hablar::s(R_I.dyn$log_I), na.rm = T)) +
labs(x = "RBC logged", y = "Asexual iRBC logged", fill = "Conversion rate") +
theme_dark()
# plot
## 20 days best cue
ggplot() +
geom_raster(data = R_I.hm, aes(x = cue_range, y = cue_range_b, fill = cr)) +
scale_fill_viridis_c() +
geom_path(data = R_I.dyn, aes(x = log_R, y = log_I), color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = R_I.dyn %>% filter(row_number() %% 1000 == 1 & time <= 20), aes(x = log_R, y = log_I), color = "white") +
xlim(0.99*min(hablar::s(R_I.dyn$log_R), na.rm = T), 1.01* max(hablar::s(R_I.dyn$log_R), na.rm = T)) +
ylim(0.99*min(hablar::s(R_I.dyn$log_I), na.rm = T),1.01* max(hablar::s(R_I.dyn$log_I), na.rm = T)) +
labs(x = "RBC log10", y = "Asexual iRBC log10", fill = "Conversion rate") +
theme_dark()
# plot
## 20 days best cue
ggplot() +
geom_raster(data = R_I.hm, aes(x = cue_range_b, y = cue_range, fill = cr)) +
scale_fill_viridis_c() +
geom_path(data = R_I.dyn, aes(x = log_R, y = log_I), color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = R_I.dyn %>% filter(row_number() %% 1000 == 1 & time <= 20), aes(x = log_I, y = log_R), color = "white") +
xlim(0.99*min(hablar::s(R_I.dyn$log_I), na.rm = T), 1.01* max(hablar::s(R_I.dyn$log_I), na.rm = T)) +
ylim(0.99*min(hablar::s(R_I.dyn$log_R), na.rm = T),1.01* max(hablar::s(R_I.dyn$log_R), na.rm = T)) +
labs(y = "RBC log10", x = "Asexual iRBC log10", fill = "Conversion rate") +
theme_dark()
# plot
## 20 days best cue
ggplot() +
geom_raster(data = R_I.hm, aes(x = cue_range_b, y = cue_range, fill = cr)) +
scale_fill_viridis_c() +
geom_path(data = R_I.dyn, aes(x = log_I, y = log_R), color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = R_I.dyn %>% filter(row_number() %% 1000 == 1 & time <= 20), aes(x = log_I, y = log_R), color = "white") +
xlim(0.99*min(hablar::s(R_I.dyn$log_I), na.rm = T), 1.01* max(hablar::s(R_I.dyn$log_I), na.rm = T)) +
ylim(0.99*min(hablar::s(R_I.dyn$log_R), na.rm = T),1.01* max(hablar::s(R_I.dyn$log_R), na.rm = T)) +
labs(y = "RBC log10", x = "Asexual iRBC log10", fill = "Conversion rate") +
theme_dark()
# plot
dual_20_fitness.pl <- ggplot() +
geom_point(data = dual_si_20.fitness, aes(y = forcats::fct_reorder(dual_label, value), x = value, color = "Dual cue"), size = 2.5, alpha = 0.7) +
geom_point(data = dual_si_20.fitness, aes(y = forcats::fct_reorder(dual_label, value), x = si_fitness_max, color= "Best single cue"), size = 2.5, alpha = 0.7) +
labs(x = "Fitness (20 days)", y = "Dual cue", color = "Cue") +
scale_color_manual(values=c("#fc8d59", "#4575b4")) +
geom_vline(xintercept = 9.883602) +
theme_bw()
# 20 days
dual_time_cr.pl <- ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value), size = 1) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
scale_color_manual(values = c("#4575b4", "#91bfdb","#fc8d59","#fdcb44")) +
theme_bw()
# plot
## 20 days best cue
ri_hm.pl <- ggplot() +
geom_raster(data = R_I.hm, aes(x = cue_range_b, y = cue_range, fill = cr)) +
scale_fill_viridis_c() +
geom_path(data = R_I.dyn, aes(x = log_I, y = log_R), color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = R_I.dyn %>% filter(row_number() %% 1000 == 1 & time <= 20), aes(x = log_I, y = log_R), color = "white") +
xlim(0.99*min(hablar::s(R_I.dyn$log_I), na.rm = T), 1.01* max(hablar::s(R_I.dyn$log_I), na.rm = T)) +
ylim(0.99*min(hablar::s(R_I.dyn$log_R), na.rm = T),1.01* max(hablar::s(R_I.dyn$log_R), na.rm = T)) +
labs(y = "RBC log10", x = "Asexual iRBC log10", fill = "Conversion rate") +
theme_dark()
ggarrange(dual_time_cr.pl, ri_hm.pl, ncol = 1)
cr_hm.pl <- ggarrange(dual_time_cr.pl, ri_hm.pl, ncol = 1, labels = c("B", "C"))
ggarrange(dual_20_fitness.pl, cr_hm.pl, ncol = 2)
ggarrange(dual_20_fitness.pl, cr_hm.pl, ncol = 2, labels = c("A", ""))
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value), size = 1) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
scale_color_manual(values = c("#4575b4", "#91bfdb","#fc8d59","#fdcb44")) +
theme_bw()
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value), size = 1) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
scale_color_manual(values = c("#4575b4", "#91bfdb","#fc8d59","#fdcb44")) +
theme_bw() +
theme(legend.position="bottom")
# 20 days
dual_time_cr.pl <- ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value), size = 1) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
scale_color_manual(values = c("#4575b4", "#91bfdb","#fc8d59","#fdcb44")) +
theme_bw() +
theme(legend.position="bottom")
cr_hm.pl <- ggarrange(dual_time_cr.pl, ri_hm.pl, ncol = 1, labels = c("B", "C"))
ggarrange(dual_20_fitness.pl, cr_hm.pl, ncol = 2, labels = c("A", ""))
ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value), size = 1) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
scale_color_manual(values = c("#4575b4", "#91bfdb","#fc8d59","#fdcb44")) +
theme_bw() +
theme(legend.position="bottom") +
guides(color = guide_legend(nrow = 2, byrow = TRUE))
# 20 days
dual_time_cr.pl <- ggplot() +
geom_line(data = dual_single_cr.20, aes(color =label_new2, x = time, y = value), size = 1) +
labs(x = "Time (days)", y = "Conversion rate", color = "Cue") +
xlim(0, 20) +
scale_color_manual(values = c("#4575b4", "#91bfdb","#fc8d59","#fdcb44")) +
theme_bw() +
theme(legend.position="bottom") +
guides(color = guide_legend(nrow = 2, byrow = TRUE))
cr_hm.pl <- ggarrange(dual_time_cr.pl, ri_hm.pl, ncol = 1, labels = c("B", "C"))
ggarrange(dual_20_fitness.pl, cr_hm.pl, ncol = 2, labels = c("A", ""))
ggsave(here("figures/report22/dual_cue_final.png"), width = 12, height = 8)
ggsave(here("figures/report22/dual_cue_final.png"), width = 12, height = 7)
ggsave(here("figures/report22/dual_cue_final.png"), width = 11, height = 7)
