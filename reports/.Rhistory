mod_1.ls[[i]] <- gls(as.formula(form[[i]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = 1, q = 0))
mod_2.ls[[i]] <- gls(as.formula(form[[i]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = 2, q = 0))
mod_3.ls[[i]] <- gls(as.formula(form[[i]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = 3, q = 0))
}
# rename models
names(mod_1.ls) <- lapply(form, function(x){paste0(x, "_1")})
names(mod_2.ls) <- lapply(form, function(x){paste0(x, "_2")})
names(mod_3.ls) <- lapply(form, function(x){paste0(x, "_3")})
# combine models
mod.ls <- c(mod_1.ls, mod_2.ls, mod_3.ls)
# run ANOVA
res <- cbind(eval(parse(text=paste("anova(",paste("mod.ls[[",1:length(mod.ls),"]]",sep="",collapse=","),")"))), name = names(mod.ls))
return(res)
}
rbc_gls <- bulk_gls2("RBC", exp_ss_dose.df)
rbc_gls <- bulk_gls2("RBC", exp_ss_dose.df)
asex_gls <- bulk_gls2("asex", exp_ss_dose.df)
gam_gls <- bulk_gls2("gam", exp_ss_dose.df)
rbc_gls %>% arrange(AIC) #RBC ~ asex_3
gam_gls %>% arrange(AIC) #gam ~ asex_3
gam_gls %>% arrange(BIC) #gam ~ asex_3
gam_gls %>% arrange(AIC) #gam ~ asex_3
gam_gls %>% arrange(BIC) #gam ~ asex_3
asex_gls %>% arrange(AIC) #asex ~ gam_3
asex_gls %>% arrange(BIC)
bulk_gls2 <- function(variable, df){
# get independent variables
ind_var <- setdiff(c("asex", "gam", "RBC"), variable)
# get list of formula based on independent variable
form <- unlist(lapply(1:2, function(n) combn(ind_var, n, FUN=function(row) paste0(variable," ~ ", paste0(row, collapse = "*")))))
# run gls modelm (need to nonvectorized because vectorizsed just doesn't want to work with ANOVA)
mod_1.ls <- list()
mod_2.ls <- list()
mod_3.ls <- list()
for(i in 1:length(form)){
mod_1.ls[[i]] <- gls(as.formula(form[[i]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = 1, q = 0))
mod_2.ls[[i]] <- gls(as.formula(form[[i]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = 2, q = 0))
mod_3.ls[[i]] <- gls(as.formula(form[[i]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = 3, q = 0))
}
# rename models
names(mod_1.ls) <- lapply(form, function(x){paste0(x, "_1")})
names(mod_2.ls) <- lapply(form, function(x){paste0(x, "_2")})
names(mod_3.ls) <- lapply(form, function(x){paste0(x, "_3")})
# combine models
mod.ls <- c(mod_1.ls, mod_2.ls, mod_3.ls)
# run ANOVA
res <- cbind(eval(parse(text=paste("anova(",paste("mod.ls[[",1:length(mod.ls),"]]",sep="",collapse=","),")"))), name = names(mod.ls))
return(res)
}
rbc_gls <- bulk_gls2("RBC", exp_ss_dose.df)
asex_gls <- bulk_gls2("asex", exp_ss_dose.df)
asex_gls <- bulk_gls2("asex", exp_ss_dose.df)
gam_gls <- bulk_gls2("gam", exp_ss_dose.df)
rbc_gls %>% arrange(AIC) #RBC ~ asex_3
asex_gls %>% arrange(AIC) #asex ~ gam_3
bulk_gls2 <- function(variable, df){
# get independent variables
ind_var <- setdiff(c("asex", "gam", "RBC"), variable)
# get list of formula based on independent variable
form <- unlist(lapply(1:2, function(n) combn(ind_var, n, FUN=function(row) paste0(variable," ~ ", paste0(row, collapse = "+")))))
# run gls modelm (need to nonvectorized because vectorizsed just doesn't want to work with ANOVA)
mod_1.ls <- list()
mod_2.ls <- list()
mod_3.ls <- list()
for(i in 1:length(form)){
mod_1.ls[[i]] <- gls(as.formula(form[[i]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = 1, q = 0))
mod_2.ls[[i]] <- gls(as.formula(form[[i]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = 2, q = 0))
mod_3.ls[[i]] <- gls(as.formula(form[[i]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = 3, q = 0))
}
# rename models
names(mod_1.ls) <- lapply(form, function(x){paste0(x, "_1")})
names(mod_2.ls) <- lapply(form, function(x){paste0(x, "_2")})
names(mod_3.ls) <- lapply(form, function(x){paste0(x, "_3")})
# combine models
mod.ls <- c(mod_1.ls, mod_2.ls, mod_3.ls)
# run ANOVA
res <- cbind(eval(parse(text=paste("anova(",paste("mod.ls[[",1:length(mod.ls),"]]",sep="",collapse=","),")"))), name = names(mod.ls))
return(res)
}
rbc_gls <- bulk_gls2("RBC", exp_ss_dose.df)
asex_gls <- bulk_gls2("asex", exp_ss_dose.df)
gam_gls <- bulk_gls2("gam", exp_ss_dose.df)
rbc_gls
test <- gls(RBC ~ gam*asex, data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = 1, q = 0))
test2 <- gls(RBC ~ gam*asex, data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = 2, q = 0))
anove(test,test2)
anova(test,test2)
test3 <- gls(RBC ~ gam*asex, data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = 3, q = 0))
anova(test,test2, test3)
test5 <- gls(RBC ~ gam*asex, data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = 5, q = 0))
anova(test,test2, test3, test5)
anova(test,test2, test3, test4, test5)
test4 <- gls(RBC ~ gam*asex, data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = 4, q = 0))
anova(test,test2, test3, test4, test5)
form
form
# get list of formula based on independent variable
form <- list(paste0(variable , "~", ind_var[[1]], "*", ind_var[[2]]),
paste0(variable , "~", ind_var[[1]], "+", ind_var[[2]]),
paste0(variable, "~", ind_var[[1]]),
paste0(variable, "~", ind_var[[2]]))
form
# get list of formula based on independent variable
form <- unlist(list(paste0(variable , "~", ind_var[[1]], "*", ind_var[[2]]),
paste0(variable , "~", ind_var[[1]], "+", ind_var[[2]]),
paste0(variable, "~", ind_var[[1]]),
paste0(variable, "~", ind_var[[2]])))
form
p <- 3
# get list of p values
p_seq <- seq(1, p, 1)
mod_1.ls <- list() <- lapply(p_seq, function(x){
gls(as.formula(form[[1]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
# run for loop gls with different p parameters
mod_1.ls <- list() <- lapply(p_seq, function(x){
gls(as.formula(form[[1]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
# run for loop gls with different p parameters
mod_1.ls <- - lapply(p_seq, function(x){
gls(as.formula(form[[1]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
# run for loop gls with different p parameters
mod_1.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[1]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_1.ls
eval(parse(text=paste("anova(",paste("mod_1.ls[[",1:length(mod_1.ls),"]]",sep="",collapse=","),")")))
cbind(eval(parse(text=paste("anova(",paste("mod_1.ls[[",1:length(mod_1.ls),"]]",sep="",collapse=","),")"))), name = form[[1]])
anova_1 <- cbind(eval(parse(text=paste("anova(",paste("mod_1.ls[[",1:length(mod_1.ls),"]]",sep="",collapse=","),")"))), name = form[[1]])
bulk_gls3 <- function(variable, df, p){
# get independent variables
ind_var <- setdiff(c("asex", "gam", "RBC"), variable)
# get list of p values
p_seq <- seq(1, p, 1)
# get list of formula based on independent variable
form <- unlist(list(paste0(variable , "~", ind_var[[1]], "*", ind_var[[2]]),
paste0(variable , "~", ind_var[[1]], "+", ind_var[[2]]),
paste0(variable, "~", ind_var[[1]]),
paste0(variable, "~", ind_var[[2]])))
# run gls modelm (need to nonvectorized because vectorizsed just doesn't want to work with ANOVA)
mod_1.ls <- list()
mod_2.ls <- list()
mod_3.ls <- list()
mod_4.ls <- list()
# run for loop gls with different p parameters
mod_1.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[1]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_2.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[2]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_3.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[3]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_4.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[4]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
# ANOVA
anova_1 <- cbind(eval(parse(text=paste("anova(",paste("mod_1.ls[[",1:length(mod_1.ls),"]]",sep="",collapse=","),")"))), name = form[[1]])
anova_2 <- cbind(eval(parse(text=paste("anova(",paste("mod_2.ls[[",1:length(mod_2.ls),"]]",sep="",collapse=","),")"))), name = form[[2]])
anova_3 <- cbind(eval(parse(text=paste("anova(",paste("mod_3.ls[[",1:length(mod_3.ls),"]]",sep="",collapse=","),")"))), name = form[[3]])
anova_4 <- cbind(eval(parse(text=paste("anova(",paste("mod_4.ls[[",1:length(mod_4.ls),"]]",sep="",collapse=","),")"))), name = form[[4]])
}
bulk_gls3("RBC", exp_ss_dose.df, 5)
bulk_gls3 <- function(variable, df, p){
# get independent variables
ind_var <- setdiff(c("asex", "gam", "RBC"), variable)
# get list of p values
p_seq <- seq(1, p, 1)
# get list of formula based on independent variable
form <- unlist(list(paste0(variable , "~", ind_var[[1]], "*", ind_var[[2]]),
paste0(variable , "~", ind_var[[1]], "+", ind_var[[2]]),
paste0(variable, "~", ind_var[[1]]),
paste0(variable, "~", ind_var[[2]])))
# run gls modelm (need to nonvectorized because vectorizsed just doesn't want to work with ANOVA)
mod_1.ls <- list()
mod_2.ls <- list()
mod_3.ls <- list()
mod_4.ls <- list()
# run for loop gls with different p parameters
mod_1.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[1]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_2.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[2]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_3.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[3]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_4.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[4]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
# ANOVA
anova_1 <- cbind(eval(parse(text=paste("anova(",paste("mod_1.ls[[",1:length(mod_1.ls),"]]",sep="",collapse=","),")"))), name = form[[1]])
anova_2 <- cbind(eval(parse(text=paste("anova(",paste("mod_2.ls[[",1:length(mod_2.ls),"]]",sep="",collapse=","),")"))), name = form[[2]])
anova_3 <- cbind(eval(parse(text=paste("anova(",paste("mod_3.ls[[",1:length(mod_3.ls),"]]",sep="",collapse=","),")"))), name = form[[3]])
anova_4 <- cbind(eval(parse(text=paste("anova(",paste("mod_4.ls[[",1:length(mod_4.ls),"]]",sep="",collapse=","),")"))), name = form[[4]])
return(anova_1, anova_2, anova_3, anova_4)
}
bulk_gls3("RBC", exp_ss_dose.df, 5)
bulk_gls3 <- function(variable, df, p){
# get independent variables
ind_var <- setdiff(c("asex", "gam", "RBC"), variable)
# get list of p values
p_seq <- seq(1, p, 1)
# get list of formula based on independent variable
form <- unlist(list(paste0(variable , "~", ind_var[[1]], "*", ind_var[[2]]),
paste0(variable , "~", ind_var[[1]], "+", ind_var[[2]]),
paste0(variable, "~", ind_var[[1]]),
paste0(variable, "~", ind_var[[2]])))
# run gls modelm (need to nonvectorized because vectorizsed just doesn't want to work with ANOVA)
mod_1.ls <- list()
mod_2.ls <- list()
mod_3.ls <- list()
mod_4.ls <- list()
# run for loop gls with different p parameters
mod_1.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[1]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_2.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[2]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_3.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[3]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_4.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[4]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
# ANOVA
anova_1 <- cbind(eval(parse(text=paste("anova(",paste("mod_1.ls[[",1:length(mod_1.ls),"]]",sep="",collapse=","),")"))), name = form[[1]])
anova_2 <- cbind(eval(parse(text=paste("anova(",paste("mod_2.ls[[",1:length(mod_2.ls),"]]",sep="",collapse=","),")"))), name = form[[2]])
anova_3 <- cbind(eval(parse(text=paste("anova(",paste("mod_3.ls[[",1:length(mod_3.ls),"]]",sep="",collapse=","),")"))), name = form[[3]])
anova_4 <- cbind(eval(parse(text=paste("anova(",paste("mod_4.ls[[",1:length(mod_4.ls),"]]",sep="",collapse=","),")"))), name = form[[4]])
return(rbind(anova_1, anova_2, anova_3, anova_4))
}
bulk_gls3("RBC", exp_ss_dose.df, 5)
bulk_gls3 <- function(variable, df, p){
# get independent variables
ind_var <- setdiff(c("asex", "gam", "RBC"), variable)
# get list of p values
p_seq <- seq(1, p, 1)
# get list of formula based on independent variable
form <- unlist(list(paste0(variable , "~", ind_var[[1]], "*", ind_var[[2]]),
paste0(variable , "~", ind_var[[1]], "+", ind_var[[2]]),
paste0(variable, "~", ind_var[[1]]),
paste0(variable, "~", ind_var[[2]])))
# run gls modelm (need to nonvectorized because vectorizsed just doesn't want to work with ANOVA)
mod_1.ls <- list()
mod_2.ls <- list()
mod_3.ls <- list()
mod_4.ls <- list()
# run for loop gls with different p parameters
mod_1.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[1]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_2.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[2]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_3.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[3]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_4.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[4]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
# ANOVA
anova_1 <- cbind(eval(parse(text=paste("anova(",paste("mod_1.ls[[",1:length(mod_1.ls),"]]",sep="",collapse=","),")"))), name = form[[1]])
anova_2 <- cbind(eval(parse(text=paste("anova(",paste("mod_2.ls[[",1:length(mod_2.ls),"]]",sep="",collapse=","),")"))), name = form[[2]])
anova_3 <- cbind(eval(parse(text=paste("anova(",paste("mod_3.ls[[",1:length(mod_3.ls),"]]",sep="",collapse=","),")"))), name = form[[3]])
anova_4 <- cbind(eval(parse(text=paste("anova(",paste("mod_4.ls[[",1:length(mod_4.ls),"]]",sep="",collapse=","),")"))), name = form[[4]])
return(list(anova_1, anova_2, anova_3, anova_4))
}
bulk_gls3("RBC", exp_ss_dose.df, 5)
8.109412e-02
bulk_gls3("asex", exp_ss_dose.df, 5)
bulk_gls3("gam", exp_ss_dose.df, 5)
bulk_gls3("asex", exp_ss_dose.df, 5) # p = 4
bulk_gls3("gam", exp_ss_dose.df, 5)
bulk_gls3("gam", exp_ss_dose.df, 10)
bulk_gls3("gam", exp_ss_dose.df, 5)
bulk_gls3("RBC", exp_ss_dose.df, 3) # consistenly p = 3
bulk_gls3("gam", exp_ss_dose.df, 3)
# set p-value of 0.01
bulk_gls3("RBC", exp_ss_dose.df, 3) # consistenly p = 3
# set p-value of 0.01
bulk_gls3("RBC", exp_ss_dose.df, 3) # consistenly p = 3
bulk_gls3("asex", exp_ss_dose.df, 3) # p = 4
bulk_gls3("gam", exp_ss_dose.df, 3)
s
bulk_gls3("asex", exp_ss_dose.df, 3) # p = 4
bulk_gls3("gam", exp_ss_dose.df, 3)
bulk_gls3 <- function(variable, df, p){
# get independent variables
ind_var <- setdiff(c("asex", "gam", "RBC"), variable)
# get list of p values
p_seq <- seq(0, p, 1)
# get list of formula based on independent variable
form <- unlist(list(paste0(variable , "~", ind_var[[1]], "*", ind_var[[2]]),
paste0(variable , "~", ind_var[[1]], "+", ind_var[[2]]),
paste0(variable, "~", ind_var[[1]]),
paste0(variable, "~", ind_var[[2]])))
# run gls modelm (need to nonvectorized because vectorizsed just doesn't want to work with ANOVA)
mod_1.ls <- list()
mod_2.ls <- list()
mod_3.ls <- list()
mod_4.ls <- list()
# run for loop gls with different p parameters
mod_1.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[1]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_2.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[2]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_3.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[3]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_4.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[4]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
# ANOVA
anova_1 <- cbind(eval(parse(text=paste("anova(",paste("mod_1.ls[[",1:length(mod_1.ls),"]]",sep="",collapse=","),")"))), name = form[[1]])
anova_2 <- cbind(eval(parse(text=paste("anova(",paste("mod_2.ls[[",1:length(mod_2.ls),"]]",sep="",collapse=","),")"))), name = form[[2]])
anova_3 <- cbind(eval(parse(text=paste("anova(",paste("mod_3.ls[[",1:length(mod_3.ls),"]]",sep="",collapse=","),")"))), name = form[[3]])
anova_4 <- cbind(eval(parse(text=paste("anova(",paste("mod_4.ls[[",1:length(mod_4.ls),"]]",sep="",collapse=","),")"))), name = form[[4]])
return(list(anova_1, anova_2, anova_3, anova_4))
}
# set p-value of 0.01
bulk_gls3("RBC", exp_ss_dose.df, 3) # consistently p = 3
mod_1.ls <- c(mod_1.ls, gls(as.formula(form[[1]]), data = exp_ss_dose.df))
bulk_gls3 <- function(variable, df, p){
# get independent variables
ind_var <- setdiff(c("asex", "gam", "RBC"), variable)
# get list of p values
p_seq <- seq(1, p, 1)
# get list of formula based on independent variable
form <- unlist(list(paste0(variable , "~", ind_var[[1]], "*", ind_var[[2]]),
paste0(variable , "~", ind_var[[1]], "+", ind_var[[2]]),
paste0(variable, "~", ind_var[[1]]),
paste0(variable, "~", ind_var[[2]])))
# run gls modelm (need to nonvectorized because vectorizsed just doesn't want to work with ANOVA)
mod_1.ls <- list()
mod_2.ls <- list()
mod_3.ls <- list()
mod_4.ls <- list()
# run for loop gls with different p parameters
mod_1.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[1]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_1.ls <- c(gls(as.formula(form[[1]]), data = exp_ss_dose.df), mod_1.ls)
#--------------------------------#
mod_2.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[2]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_2.ls <- c(gls(as.formula(form[[2]]), data = exp_ss_dose.df), mod_2.ls)
#--------------------------------#
mod_3.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[3]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_3.ls <- c(gls(as.formula(form[[3]]), data = exp_ss_dose.df), mod_3.ls)
#--------------------------------#
mod_4.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[4]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_4.ls <- c(gls(as.formula(form[[4]]), data = exp_ss_dose.df), mod_4.ls)
# ANOVA
anova_1 <- cbind(eval(parse(text=paste("anova(",paste("mod_1.ls[[",1:length(mod_1.ls),"]]",sep="",collapse=","),")"))), name = form[[1]])
anova_2 <- cbind(eval(parse(text=paste("anova(",paste("mod_2.ls[[",1:length(mod_2.ls),"]]",sep="",collapse=","),")"))), name = form[[2]])
anova_3 <- cbind(eval(parse(text=paste("anova(",paste("mod_3.ls[[",1:length(mod_3.ls),"]]",sep="",collapse=","),")"))), name = form[[3]])
anova_4 <- cbind(eval(parse(text=paste("anova(",paste("mod_4.ls[[",1:length(mod_4.ls),"]]",sep="",collapse=","),")"))), name = form[[4]])
return(list(anova_1, anova_2, anova_3, anova_4))
}
# set p-value of 0.01
bulk_gls3("RBC", exp_ss_dose.df, 3) # consistently p = 3
# run for loop gls with different p parameters
mod_1.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[1]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_1.ls <- c(gls(as.formula(form[[1]]), data = exp_ss_dose.df), mod_1.ls)
mod_1.ls
bulk_gls3 <- function(variable, df, p){
# get independent variables
ind_var <- setdiff(c("asex", "gam", "RBC"), variable)
# get list of p values
p_seq <- seq(1, p, 1)
# get list of formula based on independent variable
form <- unlist(list(paste0(variable , "~", ind_var[[1]], "*", ind_var[[2]]),
paste0(variable , "~", ind_var[[1]], "+", ind_var[[2]]),
paste0(variable, "~", ind_var[[1]]),
paste0(variable, "~", ind_var[[2]])))
# run gls modelm (need to nonvectorized because vectorizsed just doesn't want to work with ANOVA)
mod_1.ls <- list()
mod_2.ls <- list()
mod_3.ls <- list()
mod_4.ls <- list()
# run for loop gls with different p parameters
mod_1.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[1]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_1.ls <- list(gls(as.formula(form[[1]]), data = exp_ss_dose.df), mod_1.ls)
#--------------------------------#
mod_2.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[2]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_2.ls <- list(gls(as.formula(form[[2]]), data = exp_ss_dose.df), mod_2.ls)
#--------------------------------#
mod_3.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[3]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_3.ls <- list(gls(as.formula(form[[3]]), data = exp_ss_dose.df), mod_3.ls)
#--------------------------------#
mod_4.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[4]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_4.ls <- list(gls(as.formula(form[[4]]), data = exp_ss_dose.df), mod_4.ls)
# ANOVA
anova_1 <- cbind(eval(parse(text=paste("anova(",paste("mod_1.ls[[",1:length(mod_1.ls),"]]",sep="",collapse=","),")"))), name = form[[1]])
anova_2 <- cbind(eval(parse(text=paste("anova(",paste("mod_2.ls[[",1:length(mod_2.ls),"]]",sep="",collapse=","),")"))), name = form[[2]])
anova_3 <- cbind(eval(parse(text=paste("anova(",paste("mod_3.ls[[",1:length(mod_3.ls),"]]",sep="",collapse=","),")"))), name = form[[3]])
anova_4 <- cbind(eval(parse(text=paste("anova(",paste("mod_4.ls[[",1:length(mod_4.ls),"]]",sep="",collapse=","),")"))), name = form[[4]])
return(list(anova_1, anova_2, anova_3, anova_4))
}
# set p-value of 0.01
bulk_gls3("RBC", exp_ss_dose.df, 3) # consistently p = 3
test <- gls(as.formula(form[[1]]), data = exp_ss_dose.df)
test
mod_1.ls <- append(gls(as.formula(form[[1]]), data = exp_ss_dose.df), mod_1.ls)
mod_2.ls <- append(gls(as.formula(form[[2]]), data = exp_ss_dose.df), mod_2.ls)
bulk_gls3 <- function(variable, df, p){
# get independent variables
ind_var <- setdiff(c("asex", "gam", "RBC"), variable)
# get list of p values
p_seq <- seq(1, p, 1)
# get list of formula based on independent variable
form <- unlist(list(paste0(variable , "~", ind_var[[1]], "*", ind_var[[2]]),
paste0(variable , "~", ind_var[[1]], "+", ind_var[[2]]),
paste0(variable, "~", ind_var[[1]]),
paste0(variable, "~", ind_var[[2]])))
# run gls modelm (need to nonvectorized because vectorizsed just doesn't want to work with ANOVA)
mod_1.ls <- list()
mod_2.ls <- list()
mod_3.ls <- list()
mod_4.ls <- list()
# run for loop gls with different p parameters
mod_1.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[1]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_1.ls <- append(gls(as.formula(form[[1]]), data = exp_ss_dose.df), mod_1.ls)
#--------------------------------#
mod_2.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[2]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_2.ls <- append(gls(as.formula(form[[2]]), data = exp_ss_dose.df), mod_2.ls)
#--------------------------------#
mod_3.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[3]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_3.ls <- append(gls(as.formula(form[[3]]), data = exp_ss_dose.df), mod_3.ls)
#--------------------------------#
mod_4.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[4]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
mod_4.ls <- append(gls(as.formula(form[[4]]), data = exp_ss_dose.df), mod_4.ls)
# ANOVA
anova_1 <- cbind(eval(parse(text=paste("anova(",paste("mod_1.ls[[",1:length(mod_1.ls),"]]",sep="",collapse=","),")"))), name = form[[1]])
anova_2 <- cbind(eval(parse(text=paste("anova(",paste("mod_2.ls[[",1:length(mod_2.ls),"]]",sep="",collapse=","),")"))), name = form[[2]])
anova_3 <- cbind(eval(parse(text=paste("anova(",paste("mod_3.ls[[",1:length(mod_3.ls),"]]",sep="",collapse=","),")"))), name = form[[3]])
anova_4 <- cbind(eval(parse(text=paste("anova(",paste("mod_4.ls[[",1:length(mod_4.ls),"]]",sep="",collapse=","),")"))), name = form[[4]])
return(list(anova_1, anova_2, anova_3, anova_4))
}
# set p-value of 0.01
bulk_gls3("RBC", exp_ss_dose.df, 3) # consistently p = 3
bulk_gls3 <- function(variable, df, p){
# get independent variables
ind_var <- setdiff(c("asex", "gam", "RBC"), variable)
# get list of p values
p_seq <- seq(1, p, 1)
# get list of formula based on independent variable
form <- unlist(list(paste0(variable , "~", ind_var[[1]], "*", ind_var[[2]]),
paste0(variable , "~", ind_var[[1]], "+", ind_var[[2]]),
paste0(variable, "~", ind_var[[1]]),
paste0(variable, "~", ind_var[[2]])))
# run gls modelm (need to nonvectorized because vectorizsed just doesn't want to work with ANOVA)
mod_1.ls <- list()
mod_2.ls <- list()
mod_3.ls <- list()
mod_4.ls <- list()
# run for loop gls with different p parameters
mod_1.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[1]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
#--------------------------------#
mod_2.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[2]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
#--------------------------------#
mod_3.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[3]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
#--------------------------------#
mod_4.ls <- lapply(p_seq, function(x){
gls(as.formula(form[[4]]), data = exp_ss_dose.df, corr = corARMA(form = ~ 1 | id, p = x, q = 0))
})
# ANOVA
anova_1 <- cbind(eval(parse(text=paste("anova(",paste("mod_1.ls[[",1:length(mod_1.ls),"]]",sep="",collapse=","),")"))), name = form[[1]])
anova_2 <- cbind(eval(parse(text=paste("anova(",paste("mod_2.ls[[",1:length(mod_2.ls),"]]",sep="",collapse=","),")"))), name = form[[2]])
anova_3 <- cbind(eval(parse(text=paste("anova(",paste("mod_3.ls[[",1:length(mod_3.ls),"]]",sep="",collapse=","),")"))), name = form[[3]])
anova_4 <- cbind(eval(parse(text=paste("anova(",paste("mod_4.ls[[",1:length(mod_4.ls),"]]",sep="",collapse=","),")"))), name = form[[4]])
return(list(anova_1, anova_2, anova_3, anova_4))
}
# set p-value of 0.01
bulk_gls3("RBC", exp_ss_dose.df, 3) # consistently p = 3
bulk_gls3("gam", exp_ss_dose.df, 3)  # p = 1
