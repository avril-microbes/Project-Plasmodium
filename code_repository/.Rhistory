ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geom_mean, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# check # of samples
mc_single_dyn_cr_join.df_p %>% group_by(id, parameter) %>% tally()
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = fitness_det_norm, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = fitness_det_norm, y = geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = fitness_det_norm, y = geo_mean, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = fitness_det_norm, y = geo_mean, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = fitness_det_norm, y = geo_mean, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label, scales = "free") +
scale_color_viridis_c() +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = fitness_det_norm, y = geo_mean, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label, scales = "free") +
scale_color_viridis_c() +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = fitness_det_norm, y = geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label, scales = "free") +
scale_color_viridis_c() +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# relationship between fitness vs robistness
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = fitness_det_norm, y = geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label, scales = "free") +
scale_color_viridis_c() +
labs(x = "Deterministic model fitness", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# relationship between conversion rate difference and difference in fitness
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
## robust cue (I log)
mc_single_dyn_cr_join.df_p_robust <- mc_single_dyn_cr_join.df_p %>% filter(id == "I_log")
## non-robust cue (R and I+Ig log)
mc_single_dyn_cr_join.df_p_notrobust <- mc_single_dyn_cr_join.df_p %>% filter(id == "R-I+Ig_log")
## robust cue (I log)
mc_single_dyn_cr_join.df_p_robust <- mc_single_dyn_cr_join.df_p %>%
filter(id == "I_log" & parameter %in% c("beta", "psin"))
mc_single_dyn_cr_join.df_p_robust
## robust cue (I log)
mc_single_dyn_cr_join.df_p_robust <- mc_single_dyn_cr_join.df_p %>%
filter(id == "I_log" & parameter %in% c("beta", "psin") & time %% 0.1 == 0)
mc_single_dyn_cr_join.df_p_robust
## non-robust cue (R and I+Ig log)
mc_single_dyn_cr_join.df_p_notrobust <- mc_single_dyn_cr_join.df_p %>%
filter(id == "R-I+Ig_log" & parameter %in% c("beta", "psin")& time %% 0.1 == 0)
ggplot(mc_single_dyn_cr_join.df_p_robust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
facet_wrap(~parameter)
ggplot(mc_single_dyn_cr_join.df_p_notrobust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
facet_wrap(~parameter) +
theme_bw()
mc_single_dyn_cr_join.df_p_notrobust
## non-robust cue (R and I+Ig log)
mc_single_dyn_cr_join.df_p_notrobust <- mc_single_dyn_cr_join.df_p %>%
filter(id == "R_none-I+Ig_log" & parameter %in% c("beta", "psin")& time %% 0.1 == 0)
mc_single_dyn_cr_join.df_p_robust
ggplot(mc_single_dyn_cr_join.df_p_robust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
facet_wrap(~parameter) +
theme_bw()
ggplot(mc_single_dyn_cr_join.df_p_notrobust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
facet_wrap(~parameter) +
theme_bw()
## robust cue (I log)
mc_single_dyn_cr_join.df_p_robust <- mc_single_dyn_cr_join.df_p %>%
filter(id == "I_log" & parameter %in% c("beta", "psin"))
## non-robust cue (R and I+Ig log)
mc_single_dyn_cr_join.df_p_notrobust <- mc_single_dyn_cr_join.df_p %>%
filter(id == "R_none-I+Ig_log" & parameter %in% c("beta", "psin"))
ggplot(mc_single_dyn_cr_join.df_p_robust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
facet_wrap(~parameter) +
theme_bw()
ggplot(mc_single_dyn_cr_join.df_p_notrobust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
facet_wrap(~parameter) +
theme_bw()
## robust cue (I log)
mc_single_dyn_cr_join.df_p_robust <- mc_single_dyn_cr_join.df_p %>%
filter(id == "I_log" & parameter %in% c("beta", "psin")) %>%
mutate(parameter_label = case_when(
parameter == "psin" ~ "Activation indis (ψn)",
parameter == "beta" ~ "Burst size (β)"
))
## non-robust cue (R and I+Ig log)
mc_single_dyn_cr_join.df_p_notrobust <- mc_single_dyn_cr_join.df_p %>%
filter(id == "R_none-I+Ig_log" & parameter %in% c("beta", "psin")) %>%
mutate(parameter_label = case_when(
parameter == "psin" ~ "Activation indis (ψn)",
parameter == "beta" ~ "Burst size (β)"
))
mc_single_dyn_cr_join.df_p_robust
## robust cue (I log)
mc_single_dyn_cr_join.df_p_robust <- mc_single_dyn_cr_join.df_p %>%
filter(id == "I_log" & parameter %in% c("beta", "psin") & row_number() %% 10 == 0) %>%
mutate(parameter_label = case_when(
parameter == "psin" ~ "Activation indis (ψn)",
parameter == "beta" ~ "Burst size (β)"
))
mc_single_dyn_cr_join.df_p_robust
## non-robust cue (R and I+Ig log)
mc_single_dyn_cr_join.df_p_notrobust <- mc_single_dyn_cr_join.df_p %>%
filter(id == "R_none-I+Ig_log" & parameter %in% c("beta", "psin") & row_number() %% 10 == 0) %>%
mutate(parameter_label = case_when(
parameter == "psin" ~ "Activation indis (ψn)",
parameter == "beta" ~ "Burst size (β)"
))
ggplot(mc_single_dyn_cr_join.df_p_robust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
geom_line(aes(x = time, y = cr_det, group = iter), alpha = 1, color = "purple") +
facet_wrap(~parameter_label) +
ylim(0, 1) +
theme_bw()
mc_single_cr_dyn.plt1 <- ggplot(mc_single_dyn_cr_join.df_p_robust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
geom_line(aes(x = time, y = cr_det, group = iter), alpha = 1, color = blue) +
facet_wrap(~parameter_label) +
ylim(0, 1) +
labs(x = "Time (days)", y = "Conversion rate") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# color codes
orange <- "#fc8d59"
blue <- "#4575b4"
mc_single_cr_dyn.plt1 <- ggplot(mc_single_dyn_cr_join.df_p_robust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
geom_line(aes(x = time, y = cr_det, group = iter), alpha = 1, color = blue) +
facet_wrap(~parameter_label) +
ylim(0, 1) +
labs(x = "Time (days)", y = "Conversion rate") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
mc_single_cr_dyn.plt2 <- ggplot(mc_single_dyn_cr_join.df_p_notrobust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
eom_line(aes(x = time, y = cr_det, group = iter), alpha = 1, color = blue) +
facet_wrap(~parameter) +
ylim(0, 1) +
labs(x = "Time (days)", y = "Conversion rate") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
mc_single_cr_dyn.plt2 <- ggplot(mc_single_dyn_cr_join.df_p_notrobust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
geom_line(aes(x = time, y = cr_det, group = iter), alpha = 1, color = blue) +
facet_wrap(~parameter) +
ylim(0, 1) +
labs(x = "Time (days)", y = "Conversion rate") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
mc_single_cr_dyn.plt1
mc_single_cr_dyn.plt1 <- ggplot(mc_single_dyn_cr_join.df_p_robust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
geom_line(aes(x = time, y = cr_det, group = iter), alpha = 1, color = "#785EF0") +
facet_wrap(~parameter_label) +
ylim(0, 1) +
labs(x = "Time (days)", y = "Conversion rate") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
mc_single_cr_dyn.plt1
mc_single_cr_dyn.plt2 <- ggplot(mc_single_dyn_cr_join.df_p_notrobust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
geom_line(aes(x = time, y = cr_det, group = iter), alpha = 1, color = "#785EF0") +
facet_wrap(~parameter) +
ylim(0, 1) +
labs(x = "Time (days)", y = "Conversion rate") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
mc_single_cr_dyn.plt2
mc_single_cr_dyn.plt2 <- ggplot(mc_single_dyn_cr_join.df_p_notrobust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
geom_line(aes(x = time, y = cr_det, group = iter), alpha = 1, color = "#785EF0") +
facet_wrap(~parameter_label) +
ylim(0, 1) +
labs(x = "Time (days)", y = "Conversion rate") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# relationship between conversion rate difference and difference in fitness
mc_single_cr_diff.plt <- ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggarrange(mc_single_cr_dyn.plt1, mc_single_cr_dyn.plt2, nrow = 2, align = "v", labels = c("B", "C"))
ggsave(here("code_repository/figures/mc_single_cr_dyn_int.tiff"), units = "px", dpi = 300, width = 2550*(2/3), height = 1000, bg = "white", scale = 1)
ggsave(here("code_repository/figures/mc_single_cr_dyn_int.tiff"), units = "px", dpi = 300, width = 2550*(2/3), height = 1200, bg = "white", scale = 1)
# relationship between conversion rate difference and difference in fitness
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# relationship between conversion rate difference and difference in fitness
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom")
ggsave(here("code_repository/figures/mc_single_cr_rel_int.tiff"), units = "px", dpi = 300, width = 2550, height = 1200, bg = "white", scale = 1)
ggsave(here("code_repository/figures/mc_single_cr_rel_int.tiff"), units = "px", dpi = 300, width = 2550, height = 1400, bg = "white", scale = 1)
# get list of files
mc_single_dyn.ls <- list.files(here("code_repository/data/mc_single_dyn"), pattern = "*.parquet", full.names = T)
# read in all of the files, filtering only for conversion rate
mc_single_dyn_cr.ls <- mclapply(mc_single_dyn.ls, function(x){
df <- read_parquet(x)
## filter to retain only cr
df_f <- df %>% filter(variable == "cr")
return(df_f)
}, mc.cores = 6)
# write
write_parquet(mc_single_dyn_cr.df, here("code_repository/data/mc_single_dyn_cr.parquet"))
write_parquet(mc_single_dyn_cr_join.df_p, here("code_repository/data/mc_single_dyn_cr_join.parquet"))
write.csv(mc_single_dyn_cr.sum, here("code_repository/data/mc_single_dyn_cr_sum.csv"))
# relationship between conversion rate difference and difference in fitness
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom")
ggsave(here("code_repository/figures/mc_single_cr_rel_int.tiff"), units = "px", dpi = 300, width = 2550, height = 1400, bg = "white", scale = 1)
# conversion rate dynamic
ggarrange(mc_single_cr_dyn.plt1, mc_single_cr_dyn.plt2, nrow = 2, align = "v", labels = c("B", "C"))
ggsave(here("code_repository/figures/mc_single_cr_dyn_int.tiff"), units = "px", dpi = 300, width = 2550*(2/3), height = 1200, bg = "white", scale = 1)
# relationship between conversion rate difference and difference in fitness
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom")
ggsave(here("code_repository/figures/mc_single_cr_rel_int.tiff"), units = "px", dpi = 300, width = 2550, height = 1200, bg = "white", scale = 1, labels = c("D"))
ggsave(here("code_repository/figures/mc_single_cr_rel_int.tiff"), units = "px", dpi = 300, width = 2550, height = 1200, bg = "white", scale = 1)
# conversion rate dynamic
ggarrange(mc_single_cr_dyn.plt1, mc_single_cr_dyn.plt2, nrow = 2, align = "v", labels = c("B", "C"))
ggsave(here("code_repository/figures/mc_single_cr_dyn_int.tiff"), units = "px", dpi = 300, width = 2550*(2/3), height = 1200, bg = "white", scale = 1)
ggsave(here("code_repository/figures/mc_single_cr_dyn_int.tiff"), units = "px", dpi = 300, width = 2550*(2/3), height = 1200, bg = "white", scale = 1)
ggsave(here("code_repository/figures/mc_single_cr_dyn_int.tiff"), units = "px", dpi = 300, width = 2550*(2/3), height = 1000, bg = "white", scale = 1)
mc_single_cr_dyn.plt1 <- ggplot(mc_single_dyn_cr_join.df_p_robust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
geom_line(aes(x = time, y = cr_det, group = iter), alpha = 1, color = "#785EF0") +
facet_wrap(~parameter_label) +
ylim(0, 1) +
labs(x = "", y = "Conversion rate") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.title.x = element_blank())
mc_single_cr_dyn.plt2 <- ggplot(mc_single_dyn_cr_join.df_p_notrobust) +
geom_line(aes(x = time, y = value, group = iter), alpha = 0.01) +
geom_line(aes(x = time, y = cr_det, group = iter), alpha = 1, color = "#785EF0") +
facet_wrap(~parameter_label) +
ylim(0, 1) +
labs(x = "Time (days)", y = "Conversion rate") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
# conversion rate dynamic
ggarrange(mc_single_cr_dyn.plt1, mc_single_cr_dyn.plt2, nrow = 2, align = "v", labels = c("B", "C"))
ggsave(here("code_repository/figures/mc_single_cr_dyn_int.tiff"), units = "px", dpi = 300, width = 2550*(2/3), height = 1000, bg = "white", scale = 1)
# internal code to get positions of I log and R and I+Ig log
mc_single_dyn_cr.sum_fitness
# internal code to get positions of I log and R and I+Ig log
mc_single_dyn_cr.sum_fitness %>%
filter(id %in% c("I_log", "R_none-I+Ig_log"))
# internal code to get positions of I log and R and I+Ig log
mc_single_dyn_cr.sum_fitness %>%
filter(id %in% c("I_log", "R_none-I+Ig_log")) %>%
ggplot(aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom")
# internal code to get positions of I log and R and I+Ig log
mc_single_dyn_cr.sum_fitness %>%
filter(id %in% c("I_log", "R_none-I+Ig_log")) %>%
ggplot(aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
geom_text(aes(x = median_cr_diff, y =geo_mean_diff, label = id)) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom")
# internal code to get positions of I log and R and I+Ig log
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
geom_text(aes(x = median_cr_diff, y =geo_mean_diff, label = id)) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom")
# internal code to get positions of I log and R and I+Ig log
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
geom_text(aes(x = median_cr_diff, y =geo_mean_diff, label = id), color = "black") +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom")
# internal code to get positions of I log and R and I+Ig log
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
geom_text(data = mc_single_dyn_cr.sum_fitness %>% filter(id %in% c("I_log", "R_none-I+Ig_log")), aes(x = median_cr_diff, y =geo_mean_diff, label = id), color = "black") +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom")
# internal code to get positions of I log and R and I+Ig log
ggplot(mc_single_dyn_cr.sum_fitness, aes(x = median_cr_diff, geo_mean_diff, color = fitness_det_norm)) +
geom_point(size = 2.5, color = "black", shape = 1) +
geom_point(size = 2, alpha=0.8) +
geom_text(data = mc_single_dyn_cr.sum_fitness %>% filter(id %in% c("I_log", "R_none-I+Ig_log")), aes(x = median_cr_diff, y =geo_mean_diff, label = id)) +
facet_wrap(~parameter_label) +
scale_color_viridis_c() +
ylim(NA, 0.02) +
labs(x = "Median conversion rate difference", y = "Normalized fitness difference\n(Single-Deterministic)", color = "Deterministic\nmodel fitness") +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "bottom")
