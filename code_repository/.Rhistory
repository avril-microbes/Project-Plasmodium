facet_grid(rows = vars(beta_simulated), cols = vars(long_short_label)) +
labs(x = "Time (days)", y = "Conversion rate", color = "Optimized\nburst size") +
scale_color_viridis_c() +
theme_bw() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
mc_burst_cr.pl <- ggplot() +
geom_line(data = mc_burst_dyn.df_p %>% filter(beta_optimized != beta_simulated),
aes(x = time, y = value, group = beta_optimized, color = beta_optimized)) + ## only plotting unoptimized
geom_line(data = mc_burst_dyn.df_p %>% filter(beta_optimized == beta_simulated),
aes(x = time, y = value, group = beta_optimized, color = beta_optimized), linetype = "twodash", size = 1) + ## optimized cr is indicated by a dashed line
facet_grid(rows = vars(beta_simulated), cols = vars(long_short_label)) +
labs(x = "Time (days)", y = "Conversion rate", color = "Optimized\nburst size") +
scale_color_viridis_c() +
theme_bw() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
## put them together
ggarrange(mc_burst_fitness_com.pl, mc_burst_cr.pl, ncol = 2, align = "hv", labels = c("", "C"), widths = c(0.5,0.55))
## put them together
ggarrange(mc_burst_fitness_com.pl, mc_burst_cr.pl, ncol = 2, align = "hv", labels = c("", "C"), widths = c(0.5,0.55))
ggsave(units = "px", dpi = 300, width = 2650, height = 1500, filename = here("code_repository/figures/mc_burst_main.tiff"), bg = "white", scale = 1.26)
mc_burst_cr.pl <- ggplot() +
geom_line(data = mc_burst_dyn.df_p %>% filter(beta_optimized != beta_simulated),
aes(x = time, y = value, group = beta_optimized, color = beta_optimized)) + ## only plotting unoptimized
geom_line(data = mc_burst_dyn.df_p %>% filter(beta_optimized == beta_simulated),
aes(x = time, y = value, group = beta_optimized, color = beta_optimized), linetype = "dashed", size = 1) + ## optimized cr is indicated by a dashed line
facet_grid(rows = vars(beta_simulated), cols = vars(long_short_label)) +
labs(x = "Time (days)", y = "Conversion rate", color = "Optimized\nburst size") +
scale_color_viridis_c() +
theme_bw() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
mc_burst_cr.pl <- ggplot() +
geom_line(data = mc_burst_dyn.df_p %>% filter(beta_optimized != beta_simulated),
aes(x = time, y = value, group = beta_optimized, color = beta_optimized)) + ## only plotting unoptimized
geom_line(data = mc_burst_dyn.df_p %>% filter(beta_optimized == beta_simulated),
aes(x = time, y = value, group = beta_optimized, color = beta_optimized), linetype = "longdash", size = 1) + ## optimized cr is indicated by a dashed line
facet_grid(rows = vars(beta_simulated), cols = vars(long_short_label)) +
labs(x = "Time (days)", y = "Conversion rate", color = "Optimized\nburst size") +
scale_color_viridis_c() +
theme_bw() +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
## first arrange the two fitness graphs
mc_burst_fitness_com.pl <- ggarrange(mc_burst_fitness.pl, mc_burst_diff.pl, ncol = 1, align = "hv", labels = c("A", "B"), heights = c(0.6,0.4))
## put them together
ggarrange(mc_burst_fitness_com.pl, mc_burst_cr.pl, ncol = 2, align = "hv", labels = c("", "C"), widths = c(0.5,0.55))
ggsave(units = "px", dpi = 300, width = 2650, height = 1500, filename = here("code_repository/figures/mc_burst_main.tiff"), bg = "white", scale = 1.26)
mc_burst_rn_RI.df
mc_burst_rn_RI.df %>%
filter(beta ! = 3.98)
mc_burst_rn_RI.df %>%
filter(beta != 3.98)
mc_burst_rn_RI.df %>%
filter(beta != 3.98) %>%
group_by(cue_range, cue_range_b) %>%
mutate(sd = sd(cr))
mc_burst_rn_RI.df %>%
filter(beta != 3.98) %>%
group_by(cue_range, cue_range_b) %>%
mutate(sd = sd(cr)) %>%
ggplot() + geom_raster(aes(x = cue_range_b, y = cue_range, fill = sd))
## note that for each iter across the "single" and "all" dataset, the parameter alteration is the same. Thus, for each data point at which all parameter are varied, there is a corresponding datapoint where only one parameter is varied. We can join these 2 dataset by iter and cue and log
mc_single_all_fitness.df <- mc_single_fitness.df %>%
left_join(select(mc_all_fitness.df, fitness_all = max_fitness, cue, log, iter), by = c("cue", "log", "iter"))
## make the dataframe into a long format such that all fitness variations are in a single column
mc_single_fitness.long <- mc_single_all_fitness.df %>%
filter(iter != 1) %>% ## filter out iter = 1, which does not have variation
left_join(select(mc_all_fitness_ref.df, fitness_ref = max_fitness, cue , log),
by = c("cue", "log")) %>% ## add in the deterministic fitness values
select(-c("X", "rho", "burst", "iota_N1", "iota_N2", "phi_N1", "phi_N2")) %>% # keep only fitness and associated labels
tidyr::pivot_longer(-c("cue", "log", "fitness_all", "iter", "fitness_ref")) %>% ## make long
mutate(parameter = gsub("fitness_", "", name)) ## isolate parameter being altered
## calculate degree deviation from deterministic values. note that rel_diff_single ranges from -1 to 1. -1 ->  one variable perturbation is acting in the opposite direction to the overall perturbation caused by randomizing all variables. 0 parameter variation contributes very little, 1 -> one variable contributes a lot
mc_single_fitness.long_p <- mc_single_fitness.long %>%
mutate(diff_single = value-fitness_ref, ## pertubation to fitness caused by single parameter variation
diff_all = fitness_all-fitness_ref, ## pertubation to fintess caused by all parameter varying
rel_diff_single = diff_single/diff_all ## normalized pertunation to fitness (single parameter)
) %>%
left_join(ez_label, by = c("cue", "log")) %>% # get label
mutate(long_label = ifelse(cue == "R log & I log", "RBC log &\nasexual iRBC log", long_label)) ## maually assign label to dual cue data
## calculate summary statistics. this includes median, credible interval (contains 89% data points calculated via Highest Density Interval, which is better for skewed data)
mc_single_fitness.sum <- mc_single_fitness.long_p %>%
group_by(long_label, parameter) %>%
summarise(ci_lower = ci(rel_diff_single, method = "HDI", ci = 0.89)[[2]],
ci_higher = ci(rel_diff_single, method = "HDI", ci = 0.89)[[3]],
quantile_low = quantile(rel_diff_single, 0.025),
quantile_high = quantile(rel_diff_single, 0.975),
median = median(rel_diff_single),
mean = mean(rel_diff_single)) %>%
mutate(parameter_label = case_when( ## recode parameter values
parameter == "rho" ~ "RBC replenishment (ρ)",
parameter == "phin" ~ "Half-life indis (ϕn)",
parameter == "phiw" ~ "Half-life targeted (ϕw)",
parameter == "psin" ~ "Activation indis (ψn)",
parameter == "psiw" ~ "Activation targeted (ψw)",
parameter == "beta" ~ "Burst size (β)",
))
## for violin plots, what we can do is plot out only the 89% credible interval so the graph is easier to interpret
mc_single_fitness.long_p_f <- mc_single_fitness.long_p %>%
left_join(select(mc_single_fitness.sum, long_label, parameter, ci_lower, ci_higher, parameter_label), by = c("long_label", "parameter")) %>%
filter(rel_diff_single >= ci_lower & rel_diff_single < ci_higher)
## arrange ordering of cues and parameters
mc_single_fitness.long_p_f$long_label <- factor(mc_single_fitness.long_p_f$long_label,
c("RBC log &\nasexual iRBC log",
"Asexual iRBC", "Asexual iRBC log",
"Sexual iRBC", "Sexual iRBC log",
"Total iRBC", "Total iRBC log",
"Gametocyte", "Gametocyte log",
"RBC", "RBC log"))
mc_single_fitness.long_p_f$parameter_label <- factor(mc_single_fitness.long_p_f$parameter_label,
c("Burst size (β)",
"RBC replenishment (ρ)",
"Half-life indis (ϕn)",
"Half-life targeted (ϕw)",
"Activation indis (ψn)",
"Activation targeted (ψw)"))
ggplot() +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
ggplot() +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.5, color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches")))
ggplot() +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.5, color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
ggplot() +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.5, color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches")), inherit.aes = F) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
mc_burst_rn_dc.pl +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.5, color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches")))
mc_burst_RI_rug.wide
mc_burst_rn_dc.pl +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R, group = beta), size = 0.5, color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches")))
mc_burst_RI_rug.wide
ggplot() +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R, group = beta), size = 0.5, color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.5, color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches")), inherit.aes = ) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
ggplot() +
geom_line(data = mc_burst_RI_rug.wide, aes(x = I, y = R, group = beta), size = 0.5, color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.5, color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches")), inherit.aes = ) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
ggplot() +
geom_line(data = mc_burst_RI_rug.wide, aes(x = I, y = R, group = beta), size = 0.5, color = "white") +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.5, color = "white", arrow = arrow(angle = 30, length = unit(0.1, "inches")), inherit.aes = ) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
ggplot() +
geom_line(data = mc_burst_RI_rug.wide, aes(x = I, y = R, group = beta), size = 0.5, color = "white") +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
#facet_wrap(~beta, ncol = 1) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
ggplot() +
geom_line(data = mc_burst_RI_rug.wide, aes(x = I, y = R, group = beta), size = 0.5, color = "white") +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
ggplot() +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
geom_line(data = mc_burst_RI_rug.wide, aes(x = I, y = R, group = beta), size = 0.5, color = "white", inherit.aes = F) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
ggplot() +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
geom_line(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.5, color = "white", inherit.aes = F) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
mc_burst_RI_rug.wide
ggplot() +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
geom_ath(data = mc_burst_RI_rug.wide, aes(x = I, y = R, group = beta), size = 0.5, color = "white",
inherit.aes = F) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
ggplot() +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R, group = beta), size = 0.5, color = "white",
inherit.aes = F) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
ggplot() +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
geom_line(data = mc_burst_RI_rug.wide, aes(x = I, y = R, group = beta), size = 0.5, color = "white",
inherit.aes = F) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
ggplot() +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
ggplot() +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
geom_line(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.5, color = "white") +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
ggplot() +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
geom_line(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.5, color = "white", inherit.aes = F) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
ggplot() +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
geom_line(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.5, color = "white", inherit.aes = T) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
mc_burst_RI_rug.wide
ggplot() +
geom_line(mc_burst_RI_rug.wide, aes(x = R, y = I, group = beta))
ggplot() +
geom_line(data = mc_burst_RI_rug.wide, aes(x = R, y = I, group = beta))
ggplot() +
geom_line(data = mc_burst_RI_rug.wide %>% group_by(beta) %>% arrange(time), aes(x = R, y = I, group = beta))
mc_burst_RI_rug.wide %>% group_by(beta) %>% arrange(time)
ggplot() +
geom_line(data = mc_burst_RI_rug.wide %>% group_by(beta) %>% arrange(time, .by_group = T),
aes(x = R, y = I, group = beta))
mc_burst_RI_rug.wide %>% group_by(beta) %>% arrange(time, .by_group = T)
ggplot() +
geom_line(data = mc_burst_RI_rug.wide ,
aes(x = R, y = I, group = interaction(beta, time)))
ggplot() +
geom_line(data = mc_burst_RI_rug.wide ,
aes(x = R, y = I, group = time))
ggplot() +
geom_line(data = mc_burst_RI_rug.wide ,
aes(x = R, y = I, group = interaction(beta, time)))
ggplot() +
geom_line(data = mc_burst_RI_rug.wide ,
aes(x = R, y = I, group = beta))
ggplot() +
geom_line(data = mc_burst_RI_rug.wide ,
aes(x = R, y = I, group = as.factor(beta)))
ggplot(mc_burst_RI_rug.wide, aes(x = R, y = I, group = beta)) +
geom_line()
ggplot(mc_burst_RI_rug.wide %>% ungroup(), aes(x = R, y = I, group = beta)) +
geom_line()
ggplot(mc_burst_RI_rug.wide, aes(x = R, y = I, color = beta)) +
geom_line()
ggplot(mc_burst_RI_rug.wide, aes(x = R, y = I, color = beta, group = beta)) +
geom_line()
ggplot(mc_burst_RI_rug.wide, aes(x = R, y = I, color = beta, group = as.character(beta))) +
geom_line()
ggplot(mc_burst_RI_rug.wide, aes(x = R, y = I, group = as.character(beta))) +
geom_line()
ggplot(mc_burst_RI_rug.wide %>% group_by(beta) %>% arrange(time, .by_group = T), aes(x = R, y = I, group = as.character(beta))) +
geom_line()
ggplot(mc_burst_RI_rug.wide, aes(x = R, y = I, group = beta)) +
geom_line()
ggplot(mc_burst_RI_rug.wide, aes(x = R, y = I)) +
geom_line()
ggplot(mc_burst_RI_rug.wide, aes(x = R, y = I, group = beta)) +
geom_point()
mc_burst_rn_dc.pl +
ggplot(mc_burst_RI_rug.wide, aes(x = R, y = I, group = beta)) +
geom_point()
mc_burst_rn_dc.pl +
ggplot() +
geom_point(mc_burst_RI_rug.wide, aes(x = R, y = I, group = beta))
mc_burst_rn_dc.pl +
geom_point(data = mc_burst_RI_rug.wide, aes(x = R, y = I, group = beta))
mc_burst_rn_dc.pl +
geom_point(data = mc_burst_RI_rug.wide, aes(x = R, y = I))
mc_burst_rn_dc.pl +
geom_point(data = mc_burst_RI_rug.wide, aes(x = R, y = I), inherit.aes = F)
mc_burst_rn_dc.pl +
geom_point(data = mc_burst_RI_rug.wide, aes(x = R, y = I), color = "white", inherit.aes = F)
## dual cue
mc_burst_rn_dc.pl <- ggplot() +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
geom_line(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.5, color = "white", inherit.aes = T) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
mc_burst_rn_dc.pl +
geom_point(data = mc_burst_RI_rug.wide, aes(x = R, y = I), color = "white", inherit.aes = F)
## dual cue
mc_burst_rn_dc.pl <- ggplot() +
geom_raster(data = mc_burst_rn_RI.df, aes(y = cue_range, x = cue_range_b, fill = cr)) +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), size = 0.75, color = "cyan", arrow = arrow(angle = 30, length = unit(0.1, "inches"))) +
geom_point(data = mc_burst_RI_rug.wide %>% filter(time %% 1 == 0), aes(x = I, y = R), size = 1, color = "cyan") +
scale_fill_viridis_c(option = "C") +
facet_wrap(~beta, ncol = 1) +
labs(x = "Asexual iRBC log10", y = "RBC log10", fill = "Conversion\nrate") +
theme_bw() +
theme(legend.position = "bottom",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.subtitle=element_text(size=13)) +
scale_y_continuous(labels = label_number(accuracy = 0.1),
limits = c(6.8,7))
mc_burst_rn_dc.pl +
geom_point(data = mc_burst_RI_rug.wide, aes(x = R, y = I), color = "white", inherit.aes = F)
mc_burst_rn_dc.pl +
geom_point(data = mc_burst_RI_rug.wide, aes(x = I, y = R), color = "white", inherit.aes = F)
mc_burst_rn_dc.pl +
geom_line(data = mc_burst_RI_rug.wide, aes(x = I, y = R), color = "white", inherit.aes = F)
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), color = "black", inherit.aes = F)
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R, group = beta), color = "black", inherit.aes = F)
ggplot() +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R, group = beta), color = "black", inherit.aes = F)
mc_burst_rn_dc.pl +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R, group = beta), color = "white", inherit.aes = F)
mc_burst_rn_dc.pl +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), color = "white", inherit.aes = F)
ggplot() +
geom_path(data = mc_burst_RI_rug.wide, aes(x = I, y = R), color = "black", inherit.aes = F)
mc_burst_rn_dc.pl +
geom_path(data = mc_burst_RI_rug.wide %>% select(I, R, beta2 = beta), aes(x = I, y = R, group = beta2), color = "white", inherit.aes = F)
mc_burst_rn_RI.df %>%
filter(beta != 3.98) %>%
group_by(cue_range, cue_range_b) %>%
mutate(sd = sd(cr)) %>%
ggplot() + geom_raster(aes(x = cue_range_b, y = cue_range, fill = sd))
